{% extends 'base.html' %}
{% load static %}

{% block title %}Revoke Role{% endblock %}

{% block extra_css %}
<link href="{% static 'css/material-dashboard.css' %}" rel="stylesheet" />
<style>
    .confirmation-card {
        border-left: 4px solid #f44336;
        max-width: 600px;
        margin: 0 auto;
    }
    .warning-icon {
        color: #f44336;
        font-size: 4rem;
        margin-bottom: 1rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-8">
            <div class="card confirmation-card">
                <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
                    <div class="bg-gradient-danger shadow-danger border-radius-lg pt-4 pb-3">
                        <h6 class="text-white text-capitalize ps-3">Revoke Role</h6>
                        <p class="text-white ps-3 mb-0">Confirm role revocation</p>
                    </div>
                </div>
                <div class="card-body px-4 pb-2">
                    <div class="text-center mb-4">
                        <div class="warning-icon">
                            <i class="material-icons">warning</i>
                        </div>
                        <h4>Are you sure you want to revoke this role?</h4>
                    </div>
                    
                    {% if user_role %}
                        <div class="alert alert-warning">
                            <h6><strong>Role Details:</strong></h6>
                            <p class="mb-1"><strong>User:</strong> {{ user_role.user.get_full_name|default:user_role.user.email }}</p>
                            <p class="mb-1"><strong>Role:</strong> {{ user_role.role.name }}</p>
                            <p class="mb-1"><strong>Company:</strong> {{ user_role.company.company_name }}</p>
                            <p class="mb-1"><strong>Assigned:</strong> {{ user_role.assigned_at|date:"F d, Y" }}</p>
                            {% if user_role.assigned_by %}
                                <p class="mb-0"><strong>Assigned By:</strong> {{ user_role.assigned_by.get_full_name|default:user_role.assigned_by.email }}</p>
                            {% endif %}
                        </div>
                        
                        <div class="alert alert-danger">
                            <h6><strong>Warning:</strong></h6>
                            <p class="mb-0">This action will immediately revoke the user's access to features and permissions associated with this role. This action cannot be undone.</p>
                        </div>
                        
                        <form method="post" class="d-inline">
                            {% csrf_token %}
                            <div class="text-center">
                                <button type="submit" class="btn btn-danger me-2">
                                    <i class="material-icons me-2">remove_circle</i>
                                    Yes, Revoke Role
                                </button>
                                <a href="{% url 'rbac:role_management' %}" class="btn btn-secondary">
                                    <i class="material-icons me-2">cancel</i>
                                    Cancel
                                </a>
                            </div>
                        </form>
                    {% else %}
                        <div class="alert alert-danger">
                            <h6><strong>Error:</strong></h6>
                            <p class="mb-0">The specified role assignment could not be found or has already been revoked.</p>
                        </div>
                        <div class="text-center">
                            <a href="{% url 'rbac:role_management' %}" class="btn btn-primary">
                                <i class="material-icons me-2">arrow_back</i>
                                Back to Role Management
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
